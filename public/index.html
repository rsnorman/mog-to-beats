<!DOCTYPE HTML>
<!--
	Escape Velocity 2.5 by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>MOG Favorite Exporter</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,700,900" rel="stylesheet" />
		<!--[if lte IE 8]><script src="js/html5shiv.js"></script><link rel="stylesheet" href="css/ie8.css" /><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/jquery.dropotron.min.js"></script>
		<script src="js/config.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/skel-panels.min.js"></script>
		<noscript>
			<link rel="stylesheet" href="css/skel-noscript.css" />
			<link rel="stylesheet" href="css/style.css" />
			<link rel="stylesheet" href="css/style-desktop.css" />
		</noscript>
	</head>
	<body class="homepage">

		<!-- Header Wrapper -->
			<div id="header-wrapper" class="wrapper">
				<div class="container">
					<div class="row">
						<div class="12u">
						
							<!-- Header -->
								<div id="header">
									
									<!-- Logo -->
										<div id="logo">
											<h1><a href="#">MOG Favorite Exporter</a></h1>
											<span class="byline">Easy tool to transfer MOG favorites to Beats Music</span>
											<ul class="actions">
												<li>
													<input type="submit" id="begin-button" class="button button-style1" value="Begin" />
												</li>
											</ul>
										</div>

										
								</div>
							<!-- /Header -->

						</div>
					</div>
				</div>
			</div>
		<!-- /Header Wrapper -->
		
		<!-- MOG Wrapper -->
			<div id="mog-login-wrapper" class="wrapper wrapper-style3">
				<a class="title" href="javascript:;">MOG</a>
				<div class="container">
					<div class="row">
						<div class="12u">
							
								<section id="intro">
									<p class="style1">Log into MOG</p>
									<form id="mog_login" method="post" action="#">
										<div>
											<div class="row half">
												<div class="6u">
													<input type="email" class="text" name="email" id="mog-email" placeholder="Email" />
												</div>
												<div class="6u">
													<input type="password" class="text" name="password" id="mog-password" placeholder="Password" />
												</div>
											</div>
											<div class="row">
												<div class="12u">
													<ul class="actions">
														<li><input type="submit" class="button button-style3" value="Log In" /><div class="button-loader"></div></li>
													</ul>
												</div>
											</div>
										</div>
									</form>
									
								</section>
						</div>
					</div>
				</div>
			</div>
		<!-- /MOG Wrapper -->

		<!-- Beats Wrapper -->
			<div id="beats-login-wrapper" class="wrapper wrapper-style2">
				<a class="title" href="javascript:;">Beats Music</a>
				<div class="container">
					<div class="row">
						<div class="12u">
							<section id="intro">
								<p class="style1">Log into Beats Music</p>
								<form id="beats_login" method="post" action="#">
									<div>
										<div class="row half">
											<div class="6u">
												<input type="email" class="text" name="email" id="beats-email" placeholder="Email" />
											</div>
											<div class="6u">
												<input type="password" class="text" name="password" id="beats-password" placeholder="Password" />
											</div>
										</div>
										<div class="row">
											<div class="12u">
												<ul class="actions">
													<li><input type="submit" class="button button-style2" value="Log In" /><div class="button-loader"></div></li>
												</ul>
											</div>
										</div>
									</div>
								</form>
							</section>
						</div>
					</div>
				</div>
			</div>
			<!-- Beats Login -->

			<!-- Transfer Wrapper -->
<!-- 			<div id="beats-login-wrapper" class="wrapper wrapper-style3">
				<a class="title" href="javascript:;">Transfer</a>
				<div class="container">
					<div class="row">
						<div class="12u">
							<section id="intro">
								<div class="row half">
									<div class="6u">
										<p class="style1">Transfer Favorite Songs</p>
										<ul class="actions">
											<li><input id="transfer_songs" type="submit" class="button button-style3" value="Begin" /></li>
										</ul>
									</div>

									<div class="6u">
										<p class="style1">Transfer Favorite Albums</p>
										<ul class="actions">
											<li><input id="transfer_albums" type="submit" class="button button-style3" value="Begin" /></li>
										</ul>
									</div>
								</div>
							</section>
						</div>
					</div>
				</div>
			</div> -->
		<!-- /Transfer Wrapper -->
		

		<script type="text/javascript">
			var mogUsername, beatsUsername, favoriteSongs, favoriteAlbums;

			function getFavoriteSongCount() {
				$.ajax({
					url: "/mog/favorite_tracks",
					headers: {
						MOG_USER_NAME: mogUsername
					},
					success: function(songs) {
						favoriteSongs = songs;
					}
				});
			}

			function getFavoriteAlbumCount() {
				$.ajax({
					url: "/mog/favorite_albums",
					headers: {
						MOG_USER_NAME: mogUsername
					},
					success: function(albums) {
						favoriteAlbums = albums;
					}
				});
			}

			var currentPage, limit;
			limit = 10;
			currentPosition = 0;
			function transferSongs() {
				$.ajax({
					url: '/beats/favorite_tracks',
					method: 'POST',
					data: {
						limit: limit,
						start_position: currentPosition
					},
					headers: {
						MOG_USER_NAME: mogUsername,
						BEATS_USER_NAME: beatsUsername
					},
					success: function(data) {
						if (currentPosition + limit <= favoriteSongs.length) {
							currentPosition = currentPosition + limit;

							setTimeout(function() {
								transferSongs();
							}, 1000);
						}
					}
				});
			}

		   $(document).ready(function() {
		   	var $beginWrapper, $mogWrapper, $beatsWrapper;

		   	$beginWrapper = $('#header-wrapper');
		   	$mogWrapper = $('#mog-login-wrapper');
		   	$beatsWrapper = $('#beats-login-wrapper');


		   	$('#mog-login-wrapper a').click(function() {
		   		$('#mog-login-wrapper .container').show();
		   	});

		   	$('#mog_login').submit(function() {
		   		var $mogButton;
		   		$mogButton = $('#mog_login .button');
		   		$mogButton.parent().addClass('loading');
		   		$mogButton.val('');

		   		$.post("/mog/login", {
		   			username: $('#mog-email').val(),
		   			password: $('#mog-password').val()
		   		}, function(data) {
		   			mogUsername = $('#mog-email').val();
		   			$mogButton.parent().removeClass('loading');
		   			$beatsWrapper.addClass('visible');
		   		});
		   		return false;
		   	});

		   	$('#beats_login').submit(function() {
		   		var $beatsButton;
		   		$beatsButton = $('#beats_login .button');
		   		$beatsButton.parent().addClass('loading');
		   		$beatsButton.val('');

		   		$.post("/beats/login", {
		   			username: $('#beats-email').val(),
		   			password: $('#beats-password').val()
		   		}, function(data) {
		   			beatsUsername = $('#beats-email').val();

		   			getFavoriteSongCount();
		   			getFavoriteAlbumCount();
		   		});
		   		return false;
		   	});

		   	$('#transfer_songs').click(transferSongs);

		   	$('#begin-button').click(function() {
		   		$('#mog-login-wrapper').addClass('visible');
		   	});
		   });
		</script>
	</body>
</html>